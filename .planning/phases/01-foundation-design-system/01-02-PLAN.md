---
phase: 01-foundation-design-system
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [index.html]
autonomous: true

must_haves:
  truths:
    - "User can view page in dark mode without white flash on load (FOUC prevented)"
    - "User sees content with proper typography (Syne headings, IBM Plex Sans body, IBM Plex Mono code)"
    - "User sees readable content on mobile (320px), tablet (768px), and desktop (1024px+) with proper spacing"
    - "Page uses dark mode design system with CSS custom properties matching PRD color palette"
    - "All sections display with consistent padding (6rem vertical on desktop, 3rem on mobile)"
  artifacts:
    - path: "index.html"
      provides: "Complete CSS design system in <style> tag"
      contains: ":root {"
    - path: "index.html"
      provides: "Dark mode FOUC prevention script in <head>"
      contains: "localStorage.getItem('theme')"
    - path: "index.html"
      provides: "Responsive layout styles"
      contains: "@media (min-width:"
  key_links:
    - from: "Inline blocking script"
      to: "localStorage"
      via: "theme preference check"
      pattern: "localStorage\\.getItem\\('theme'\\)"
    - from: "CSS custom properties"
      to: ".dark class"
      via: "theme override"
      pattern: "\\.dark \\{"
    - from: "Component styles"
      to: "CSS custom properties"
      via: "var() references"
      pattern: "var\\(--[a-z-]+"
---

<objective>
Implement complete dark mode design system with CSS custom properties, responsive layouts, and FOUC prevention to ensure professional visual presentation across all devices.

Purpose: Establish the visual foundation that supports all future content and animations. This plan prevents the critical dark mode FOUC pitfall and creates a maintainable design system using CSS variables for instant theme switching.

Output: Fully styled dark mode landing page with responsive design, proper typography, and zero flash on load.
</objective>

<execution_context>
@/Users/mmaudet/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mmaudet/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/research/STACK.md
@.planning/research/ARCHITECTURE.md
@.planning/research/PITFALLS.md
</context>

<tasks>

<task type="auto">
  <name>Define CSS custom properties design system with dark mode theming</name>
  <files>index.html</files>
  <action>
Add complete `<style>` section to <head> of index.html (after external CDN links but before body).

**Structure (ARCHITECTURE.md lines 92-112):**

```css
/* 1. CSS Custom Properties (Design Tokens) */
:root {
  /* Primitive tokens (raw color values) */
  /* Use OKLCH color space for better dark mode (Tailwind v4 default) */
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-900: #111827;
  --gray-950: #0a0a0a;
  --blue-500: #3b82f6;
  --blue-600: #2563eb;
  --indigo-600: #4f46e5;

  /* Semantic tokens (light mode defaults) */
  --color-bg: var(--gray-50);
  --color-bg-elevated: var(--gray-100);
  --color-text: var(--gray-900);
  --color-text-muted: #6b7280;
  --color-primary: var(--indigo-600);
  --color-accent: var(--blue-600);
  --color-border: #e5e7eb;

  /* Spacing tokens */
  --space-section: 6rem 1.5rem; /* Desktop: 96px vertical, 24px horizontal */
  --space-section-mobile: 3rem 1.5rem; /* Mobile: 48px vertical, 24px horizontal */
  --container-max: 1200px;

  /* Component tokens */
  --nav-height: 4rem;
  --border-radius: 0.5rem;
  --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
}

/* Dark mode overrides (only redefine semantic layer) */
.dark {
  --color-bg: var(--gray-950);
  --color-bg-elevated: var(--gray-900);
  --color-text: var(--gray-50);
  --color-text-muted: #9ca3af;
  --color-primary: #6366f1; /* Lighter for contrast */
  --color-accent: #60a5fa; /* Lighter blue */
  --color-border: #374151;
  --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.5);
}
```

**2. Base Styles:**
- CSS Reset (margin/padding reset, box-sizing: border-box)
- Body: background var(--color-bg), color var(--color-text), font-family IBM Plex Sans
- Typography: H1-H6 with Syne font, proper line-height (1.2 for headings, 1.6 for body)
- Links: color var(--color-primary), no underline, hover underline
- Smooth scroll: `html { scroll-behavior: smooth; }`

**3. Container/Layout Utilities:**
- `.container`: max-width var(--container-max), margin 0 auto, padding 0 1.5rem

**Typography Scale (matching PRD):**
- H1: 3rem (48px) desktop, 2.25rem (36px) mobile
- H2: 2.25rem (36px) desktop, 1.875rem (30px) mobile
- H3: 1.5rem (24px)
- Body: 1rem (16px), line-height 1.6

Reference STACK.md lines 182-219 for dark mode implementation pattern, ARCHITECTURE.md lines 226-256 for CSS custom properties theming pattern.

**Critical: Use layered token system** (Primitive → Semantic → Component) so dark mode only redefines semantic layer, not every color instance.
  </action>
  <verify>
1. Open index.html in browser
2. Open DevTools Elements, inspect <html> element
3. Verify :root CSS variables defined in Computed styles
4. Toggle `.dark` class on <html> manually in DevTools
5. Confirm all colors change instantly without flicker
6. Check that component styles reference var(--color-*) not hardcoded hex values
  </verify>
  <done>
CSS custom properties defined in :root and .dark, all colors use semantic tokens, toggling .dark class changes theme instantly with zero layout shift.
  </done>
</task>

<task type="auto">
  <name>Create responsive base styles and component CSS</name>
  <files>index.html</files>
  <action>
Add component styles to <style> section (after base styles from Task 1).

**Component Styles (reference REQUIREMENTS.md DS-03, DS-04, DS-05):**

**Navigation:**
- Sticky positioning (position: sticky, top: 0, z-index: 50)
- Height: var(--nav-height)
- Flex layout: space-between, align center
- Background: var(--color-bg) with backdrop-blur (Phase 6 will add transparency on scroll)
- Logo: Syne Bold, font-size 1.5rem
- Desktop nav links: horizontal flex, gap 2rem, hidden on mobile
- CTA button: primary button styles
- Hamburger icon: hidden on desktop, visible on mobile, 3 horizontal bars

**Buttons (DS-03 button specs):**
- `.btn-primary`: background var(--color-primary), white text, padding 0.75rem 2rem, border-radius var(--border-radius), hover: scale(1.05), transition 300ms
- `.btn-secondary`: border 2px solid var(--color-primary), transparent bg, color var(--color-primary), same padding/radius, hover: background var(--color-primary), white text
- `.btn-ghost`: no border, color var(--color-text-muted), hover: color var(--color-primary)
- Minimum touch target: 48px height (PITFALLS.md lines 321-360)

**Cards (DS-03):**
- Background: var(--color-bg-elevated)
- Border: 1px solid var(--color-border)
- Border-radius: var(--border-radius)
- Padding: 1.5rem
- Box-shadow: var(--shadow)
- Hover: translateY(-4px), increased shadow (Phase 6 will add full hover animations)

**Badges:**
- Uppercase text, small font (0.875rem), letter-spacing 0.1em
- Color: var(--color-accent)
- Display: inline-block, margin-bottom 1rem

**Sections:**
- Padding: var(--space-section) on desktop
- Text-align: center for headers
- Max-width: var(--container-max) centered

**Footer:**
- Background: var(--color-bg-elevated)
- Padding: 3rem 1.5rem
- Border-top: 1px solid var(--color-border)
- Grid layout: 3 columns on desktop, 1 column on mobile

**Responsive Breakpoints (mobile-first, DS-04):**
```css
/* Base: 0-767px (mobile) - default styles above */

@media (min-width: 768px) {
  /* Tablet */
  :root {
    --space-section: 6rem 1.5rem; /* Increase vertical padding */
  }

  /* Show desktop nav, hide hamburger */
  .nav-desktop { display: flex; }
  .nav-mobile { display: none; }

  /* 2-column layouts where appropriate */
}

@media (min-width: 1024px) {
  /* Desktop */
  .container {
    padding: 0 3rem; /* More breathing room */
  }

  /* 3-column layouts */
}

@media (min-width: 1440px) {
  /* Large desktop */
  /* Optional: slightly larger typography */
}
```

**Forms:**
- Input fields: padding 0.75rem, border 1px solid var(--color-border), border-radius var(--border-radius), background var(--color-bg)
- Focus state: outline 2px solid var(--color-primary), outline-offset 2px
- Labels: margin-bottom 0.5rem, color var(--color-text)

**Critical from PITFALLS.md:**
- All interactive elements minimum 48x48px touch targets (line 329)
- Use transform for hover effects, not top/left (avoid layout thrashing, line 293)
- Mobile-first breakpoints (line 632)

Reference ARCHITECTURE.md lines 760-806 for build order (foundation first, layout second, interactivity third).
  </action>
  <verify>
1. Open index.html in browser at different widths (320px, 768px, 1024px, 1440px)
2. Use Chrome DevTools Responsive Mode to test breakpoints
3. Verify hamburger menu visible only on mobile (<768px)
4. Verify desktop nav links visible only on tablet+ (≥768px)
5. Confirm all buttons ≥48px height
6. Test hover states on buttons and cards
7. Verify sections have proper padding at each breakpoint
8. Check color contrast in dark mode meets WCAG AA (4.5:1 ratio)
  </verify>
  <done>
All component styles render correctly, responsive breakpoints work, mobile shows hamburger, desktop shows nav links, touch targets meet 48px minimum, hover states smooth, dark mode colors have sufficient contrast.
  </done>
</task>

<task type="auto">
  <name>Add dark mode FOUC prevention inline script</name>
  <files>index.html</files>
  <action>
Add inline blocking script to <head> BEFORE any CSS (critical for FOUC prevention).

**Script Location:** Immediately after charset and viewport meta tags, BEFORE Tailwind CDN and <style> tag.

**Script Content (PITFALLS.md lines 36-54, STACK.md lines 203-218):**

```html
<script>
  // CRITICAL: Runs before page renders to prevent dark mode FOUC
  // Must be inline and blocking (no defer, no async, no external file)

  (function() {
    // Check localStorage for saved preference
    const savedTheme = localStorage.getItem('theme');

    // Check system preference
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

    // Determine theme: saved preference takes priority, fallback to system
    const isDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);

    // Apply .dark class immediately if needed
    if (isDark) {
      document.documentElement.classList.add('dark');
    }
  })();
</script>
```

**Why this works (from PITFALLS.md):**
- Inline script executes before CSS parsing → no white flash
- Checks localStorage first (user override) then system preference
- Applies .dark class synchronously before first paint
- IIFE pattern prevents global scope pollution

**Why NOT to defer/async/externalize:**
- External script loads after HTML parsing → causes FOUC
- defer/async attributes allow HTML to render first → causes FOUC
- Must be blocking to prevent flash

This is the ONLY acceptable blocking script in the entire project. All other JS will be deferred (Phase 2+).

Reference ARCHITECTURE.md lines 69-70 for Theme Manager pattern (this script is the initialization, full Theme Manager with toggle comes in Phase 6).

**Testing checklist:**
- First load (no localStorage): Should default to system preference
- Set localStorage to 'dark': Page loads dark immediately
- Set localStorage to 'light': Page loads light immediately
- Refresh multiple times: No white flash observed
  </action>
  <verify>
1. Clear localStorage: `localStorage.clear()`
2. Set system to dark mode in OS settings
3. Reload page → should load dark with NO white flash
4. Open DevTools Console: `localStorage.setItem('theme', 'light')`
5. Reload page → should load light with NO white flash
6. Set to dark: `localStorage.setItem('theme', 'dark')`
7. Reload page → should load dark with NO white flash
8. Use Lighthouse Performance audit → verify no Cumulative Layout Shift (CLS should be 0)
9. Use DevTools Performance recording during page load → verify no style recalculation before first paint
  </verify>
  <done>
Inline script present in <head> before CSS, dark mode applies instantly on page load without flash, localStorage preference persists across reloads, system preference respected when no saved preference exists, Lighthouse CLS score is 0.
  </done>
</task>

</tasks>

<verification>
**Design System:**
- [ ] CSS custom properties defined in :root (primitives, semantic, component tokens)
- [ ] .dark class overrides semantic tokens only
- [ ] All component styles reference var(--color-*) not hardcoded colors
- [ ] Typography uses Syne (headings) and IBM Plex Sans (body)
- [ ] Spacing tokens used consistently (--space-section, etc.)

**Responsive Design:**
- [ ] Mobile-first approach (base styles for 320px+)
- [ ] Breakpoints at 768px, 1024px, 1440px
- [ ] Hamburger menu visible only on mobile
- [ ] Desktop nav links visible only on tablet+
- [ ] Container max-width 1200px
- [ ] Section padding: 6rem vertical (desktop), 3rem (mobile)

**Dark Mode FOUC Prevention:**
- [ ] Inline script in <head> BEFORE CSS
- [ ] Script checks localStorage first, then system preference
- [ ] .dark class applied synchronously before first paint
- [ ] No white flash on page load (test multiple times)
- [ ] localStorage persistence works

**Component Styles:**
- [ ] Buttons: primary, secondary, ghost variants all styled
- [ ] All buttons ≥48px height (touch target requirement)
- [ ] Cards: background, border, shadow, hover effect
- [ ] Badges: uppercase, accent color, proper spacing
- [ ] Forms: inputs styled with focus states
- [ ] Footer: proper layout, border-top

**Performance:**
- [ ] Lighthouse CLS (Cumulative Layout Shift) = 0
- [ ] No layout recalculation before first paint
- [ ] Color contrast meets WCAG AA (4.5:1 ratio)
- [ ] No console errors

**Cross-Browser:**
- [ ] Test in Chrome (desktop + mobile)
- [ ] Test in Firefox
- [ ] Test in Safari
- [ ] Verify dark mode works in all browsers
</verification>

<success_criteria>
1. Page loads in dark mode with zero white flash (FOUC eliminated)
2. All 9 sections display with proper typography and spacing
3. Responsive design works at 320px, 768px, 1024px, 1440px widths
4. Toggling .dark class in DevTools changes all colors instantly
5. localStorage theme preference persists across page reloads
6. All interactive elements meet 48px minimum touch target size
7. Lighthouse Performance score ≥90 (no layout shift)
8. Color contrast in dark mode meets WCAG AA standards
9. CSS custom properties used throughout (no hardcoded colors)
10. Mobile shows hamburger menu, desktop shows nav links
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-design-system/01-02-SUMMARY.md`
</output>
